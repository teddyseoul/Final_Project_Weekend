<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="AdminMapper">
	<!-- 유저 -->
	<resultMap type="com.project.weekend.member.MemberDTO" id="member">
		<id property="id" column="id"/>
		<result property="pw" column="pw"/>
		<result property="name" column="name"/>
		<result property="age" column="age"/>
		<result property="email" column="email"/>
		<result property="phone" column="phone"/>
		<result property="grade" column="grade"/>
		<result property="nickname" column="nickname"/>
	</resultMap>
	<!-- 유저 리스트 -->
	<select id="getList" parameterType="Integer" resultType="MemberDTO">
		SELECT * FROM
		(SELECT ROWNUM R, M. *FROM
		(SELECT ID, NAME, AGE, EMAIL, PHONE, GRADE, NICKNAME FROM MEMEBER WHERE
		<choose>
			<when test="KIND == 1">
				ID LIKE '%'||#{SEARCH}||'%'
			</when>
			<when test="KIND == 2">
				NICKNAME LIKE '%'||#{search}||'%'
			</when>
			<otherwise>
				GRADE LIKE '%'||#{search}||'%'
			</otherwise>
		</choose>
		ORDER BY GRADE DESC) M)
		WHERE R BETWEEN #{startRow} AND #{lastRow}		
	</select>
	<!-- 유저 선택 -->
	<select id="getSelect" resultMap="member" parameterType="MemberDTO">
		select M.*, F.*
		from member M full join MEMBERFILE F
		on (M.id=F.id)
		where M.id=#{id} and M.pw=#{pw}
	</select>
	<!-- 유저 등급 수정 -->
	<update id="setUpdate" parameterType="MemberDTO">
		UPDATE MEMBER SET GRADE = #{GRADE}
	</update>
	<!-- 유저 삭제 -->
	<delete id="setDelete" parameterType="Integer">
		DELETE * FROM MEMBER WHERE NUM = #{NUM}
	</delete>
</mapper>